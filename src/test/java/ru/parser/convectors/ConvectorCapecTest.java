package ru.parser.convectors;

import org.junit.jupiter.api.Test;

import java.io.IOException;
import java.util.List;
import java.util.Set;

import static org.junit.jupiter.api.Assertions.assertEquals;

class ConvectorCapecTest {

    @Test
    void convectorCapecTest() throws IOException {
        var convert = new ConvectorCapec();
        var url = "https://cwe.mitre.org/data/definitions/284.html";

        var map = convert.convert(url);
        var mediumList = List.of("441", "552", "578");
        var highList = List.of("19");
        var lowList = List.of("478", "479", "536", "546", "558");
        var noChanceList = List.of("502", "503", "550", "551", "556", "562", "563", "564");
        var keyTest = Set.of("High", "Low", "Medium", "No chance");

        var resultKey = map.keySet();

        assertEquals(keyTest, resultKey);
        assertEquals(highList, map.get("High"));
        assertEquals(mediumList, map.get("Medium"));
        assertEquals(lowList, map.get("Low"));
        assertEquals(noChanceList, map.get("No chance"));
    }

}
