package ru.parser.utilits;

import lombok.AccessLevel;
import lombok.experimental.FieldDefaults;
import ru.parser.builders.BuilderExcel;
import ru.parser.convectors.Convector;
import ru.parser.convectors.ConvectorHtmlReport;

import java.io.IOException;

@FieldDefaults(level = AccessLevel.PRIVATE)
public final class CreateExcelFile {

    public <T> void createExcelFile(String path, Convector<T> convector, BuilderExcel<T> builder) throws IOException {

        var convertReportHtml = new ConvectorHtmlReport();

        var titleVulnerability = convertReportHtml.convert(path);

        titleVulnerability.parallelStream()
                .forEach(vul -> {
                    try {
                        var row = convector.convert(vul);
                        builder.createRow(row);
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                });
    }
}
