package ru.parser;

import lombok.AccessLevel;
import lombok.experimental.FieldDefaults;
import ru.parser.builders.BuildItemExcel;
import ru.parser.convectors.ConvectorItem;
import ru.parser.utilits.CreateExcelFile;

import java.io.IOException;

@FieldDefaults(level = AccessLevel.PRIVATE, makeFinal = true)
public class Main {

    public static void main(String[] args) {

        try (var builderExcel = new BuildItemExcel()) {

            var convert = new CreateExcelFile();
            var convectorItem = new ConvectorItem();

            System.out.println("Пожалуйста подождите, файл создается!");
            convert.createExcelFile(args[0], convectorItem, builderExcel);
            System.out.println("Файл создан!");

        } catch (IOException e) {
            System.out.println("Указаный файл не найден!");
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("Введите путь к отчету!");
        }
    }

}
